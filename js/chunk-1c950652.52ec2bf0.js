(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c950652"],{"885a":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.$common.isEmpty(e.currentUser)?s("div",{staticClass:"myCenter in-up-container my-animation-hideToShow"},[e._m(0),s("div",{staticClass:"in-up",attrs:{id:"loginAndRegist"}},[s("div",{staticClass:"form-container sign-up-container"},[s("div",{staticClass:"myCenter"},[s("h1",[e._v("注册")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",maxlength:"30",placeholder:"用户名"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",maxlength:"30",placeholder:"密码"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email",placeholder:"邮箱"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.code,expression:"code"}],attrs:{type:"text",placeholder:"验证码",disabled:""},domProps:{value:e.code},on:{input:function(t){t.target.composing||(e.code=t.target.value)}}}),s("a",{staticStyle:{margin:"0"},attrs:{href:"#"},on:{click:function(t){return e.changeDialog("邮箱验证码")}}},[e._v("获取验证码")]),s("button",{on:{click:function(t){return e.regist()}}},[e._v("注册")])])]),s("div",{staticClass:"form-container sign-in-container"},[s("div",{staticClass:"myCenter"},[s("h1",[e._v("登录")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.account,expression:"account"}],attrs:{type:"text",placeholder:"用户名/邮箱/手机号"},domProps:{value:e.account},on:{input:function(t){t.target.composing||(e.account=t.target.value)}}}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),s("a",{attrs:{href:"#"},on:{click:function(t){return e.changeDialog("找回密码")}}},[e._v("忘记密码？")]),s("button",{on:{click:function(t){return e.login()}}},[e._v("登录")])])]),s("div",{staticClass:"overlay-container"},[s("div",{staticClass:"overlay"},[s("div",{staticClass:"overlay-panel myCenter overlay-left"},[s("h1",[e._v("已有帐号？")]),s("p",[e._v("请登录🚀")]),s("button",{staticClass:"ghost",on:{click:function(t){return e.signIn()}}},[e._v("登录")])]),s("div",{staticClass:"overlay-panel myCenter overlay-right"},[s("h1",[e._v("没有帐号？")]),s("p",[e._v("立即注册吧😃")]),s("button",{staticClass:"ghost",on:{click:function(t){return e.signUp()}}},[e._v("注册")])])])])])],1):s("div",{staticClass:"user-container myCenter my-animation-hideToShow"},[e._m(1),s("div",{staticClass:"shadow-box-mini user-info",staticStyle:{display:"flex"}},[s("div",{staticClass:"user-left"},[s("div",[s("el-avatar",{staticClass:"user-avatar",attrs:{size:60,src:e.currentUser.avatar},nativeOn:{click:function(t){return e.changeDialog("修改头像")}}})],1),s("div",{staticClass:"myCenter",staticStyle:{"margin-top":"12px"}},[e._m(2),s("div",{staticClass:"user-content"},[s("div",[s("el-input",{attrs:{maxlength:"30"},model:{value:e.currentUser.username,callback:function(t){e.$set(e.currentUser,"username",t)},expression:"currentUser.username"}})],1),s("div",[e.$common.isEmpty(e.currentUser.phoneNumber)?s("div",[s("span",{staticClass:"changeInfo",on:{click:function(t){return e.changeDialog("绑定手机号")}}},[e._v("绑定手机号（功能未接入）")])]):s("div",[e._v(" "+e._s(e.currentUser.phoneNumber)+" "),s("span",{staticClass:"changeInfo",on:{click:function(t){return e.changeDialog("修改手机号")}}},[e._v("修改（功能未接入）")])])]),s("div",[e.$common.isEmpty(e.currentUser.email)?s("div",[s("span",{staticClass:"changeInfo",on:{click:function(t){return e.changeDialog("绑定邮箱")}}},[e._v("绑定邮箱")])]):s("div",[e._v(" "+e._s(e.currentUser.email)+" "),s("span",{staticClass:"changeInfo",on:{click:function(t){return e.changeDialog("修改邮箱")}}},[e._v("修改")])])]),s("div",[s("el-radio-group",{model:{value:e.currentUser.gender,callback:function(t){e.$set(e.currentUser,"gender",t)},expression:"currentUser.gender"}},[s("el-radio",{staticStyle:{"margin-right":"10px"},attrs:{label:0}},[e._v("薛定谔的猫")]),s("el-radio",{staticStyle:{"margin-right":"10px"},attrs:{label:1}},[e._v("男")]),s("el-radio",{attrs:{label:2}},[e._v("女")])],1)],1),s("div",[s("el-input",{attrs:{maxlength:"60",type:"textarea","show-word-limit":""},model:{value:e.currentUser.introduction,callback:function(t){e.$set(e.currentUser,"introduction",t)},expression:"currentUser.introduction"}})],1)])]),s("div",{staticStyle:{"margin-top":"20px"}},[s("proButton",{attrs:{info:"提交",before:e.$constant.before_color_2,after:e.$constant.after_color_2},nativeOn:{click:function(t){return e.submitUserInfo()}}})],1)]),s("div",{staticClass:"user-right"})])],1),s("el-dialog",{attrs:{title:e.dialogTitle,visible:e.showDialog,width:"30%","before-close":e.clearDialog,"append-to-body":!0,"close-on-click-modal":!1,center:""},on:{"update:visible":function(t){e.showDialog=t}}},[s("div",{staticClass:"myCenter",staticStyle:{"flex-direction":"column"}},[s("div",["修改手机号"===e.dialogTitle||"绑定手机号"===e.dialogTitle?s("div",[s("div",{staticStyle:{"margin-bottom":"5px"}},[e._v("手机号：")]),s("el-input",{model:{value:e.phoneNumber,callback:function(t){e.phoneNumber=t},expression:"phoneNumber"}}),s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"5px"}},[e._v("验证码：")]),s("el-input",{model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"5px"}},[e._v("密码：")]),s("el-input",{model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):"修改邮箱"===e.dialogTitle||"绑定邮箱"===e.dialogTitle?s("div",[s("div",{staticStyle:{"margin-bottom":"5px"}},[e._v("邮箱：")]),s("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"5px"}},[e._v("验证码：")]),s("el-input",{model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"5px"}},[e._v("密码：")]),s("el-input",{model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):"修改头像"===e.dialogTitle?s("div",[s("uploadPicture",{attrs:{prefix:"userAvatar",maxSize:1,maxNumber:1},on:{addPicture:e.addPicture}})],1):"找回密码"===e.dialogTitle?s("div",[s("div",{staticClass:"myCenter",staticStyle:{"margin-bottom":"12px"}},[s("el-radio-group",{model:{value:e.passwordFlag,callback:function(t){e.passwordFlag=t},expression:"passwordFlag"}},[s("el-radio",{staticStyle:{"margin-right":"10px"},attrs:{label:1}},[e._v("手机号")]),s("el-radio",{attrs:{label:2}},[e._v("邮箱")])],1)],1),1===e.passwordFlag?s("div",[s("div",{staticStyle:{"margin-bottom":"5px"}},[e._v("手机号：")]),s("el-input",{model:{value:e.phoneNumber,callback:function(t){e.phoneNumber=t},expression:"phoneNumber"}}),s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"5px"}},[e._v("验证码：")]),s("el-input",{model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"5px"}},[e._v("新密码：")]),s("el-input",{attrs:{maxlength:"30"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):2===e.passwordFlag?s("div",[s("div",{staticStyle:{"margin-bottom":"5px"}},[e._v("邮箱：")]),s("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"5px"}},[e._v("验证码：")]),s("el-input",{model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"5px"}},[e._v("新密码：")]),s("el-input",{attrs:{maxlength:"30"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1):e._e()]):"邮箱验证码"===e.dialogTitle?s("div",[s("div",[s("div",{staticStyle:{"margin-bottom":"5px"}},[e._v("邮箱：")]),s("el-input",{model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),s("div",{staticStyle:{"margin-top":"10px","margin-bottom":"5px"}},[e._v("验证码：")]),s("el-input",{model:{value:e.code,callback:function(t){e.code=t},expression:"code"}})],1)]):e._e()]),s("div",{directives:[{name:"show",rawName:"v-show",value:"修改头像"!==e.dialogTitle,expression:"dialogTitle !== '修改头像'"}],staticStyle:{display:"flex","margin-top":"30px"}},[s("proButton",{directives:[{name:"show",rawName:"v-show",value:"修改手机号"===e.dialogTitle||"绑定手机号"===e.dialogTitle||"修改邮箱"===e.dialogTitle||"绑定邮箱"===e.dialogTitle||"找回密码"===e.dialogTitle||"邮箱验证码"===e.dialogTitle,expression:"dialogTitle === '修改手机号' || dialogTitle === '绑定手机号' || dialogTitle === '修改邮箱' || dialogTitle === '绑定邮箱' || dialogTitle === '找回密码' || dialogTitle === '邮箱验证码'"}],staticStyle:{"margin-right":"20px"},attrs:{info:e.codeString,before:e.$constant.before_color_1,after:e.$constant.after_color_1},nativeOn:{click:function(t){return e.getCode()}}}),s("proButton",{attrs:{info:"提交",before:e.$constant.before_color_2,after:e.$constant.after_color_2},nativeOn:{click:function(t){return e.submitDialog()}}})],1)])])],1)},i=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-image",{staticClass:"my-el-image",staticStyle:{position:"absolute"},attrs:{lazy:"",src:e.$store.state.webInfo.randomCover[Math.floor(Math.random()*e.$store.state.webInfo.randomCover.length)],fit:"cover"}},[s("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-image",{staticClass:"my-el-image",staticStyle:{position:"absolute"},attrs:{lazy:"",src:e.$store.state.webInfo.randomCover[Math.floor(Math.random()*e.$store.state.webInfo.randomCover.length)],fit:"cover"}},[s("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-title"},[s("div",[e._v("用户名：")]),s("div",[e._v("手机号：")]),s("div",[e._v("邮箱：")]),s("div",[e._v("性别：")]),s("div",[e._v("简介：")])])}],o=(s("d3b7"),s("3ca3"),s("ddb0"),s("498a"),s("ac1f"),s("00b4"),function(){return s.e("chunk-94e299d0").then(s.bind(null,"ff66"))}),r=function(){return s.e("chunk-4279e0f6").then(s.bind(null,"6034"))},n={components:{proButton:o,uploadPicture:r},data:function(){return{currentUser:this.$store.state.currentUser,username:"",account:"",password:"",phoneNumber:"",email:"",avatar:"",showDialog:!1,code:"",dialogTitle:"",codeString:"验证码",passwordFlag:null,intervalCode:null}},computed:{},created:function(){},methods:{addPicture:function(e){this.avatar=e,this.submitDialog()},signUp:function(){document.querySelector("#loginAndRegist").classList.add("right-panel-active")},signIn:function(){document.querySelector("#loginAndRegist").classList.remove("right-panel-active")},login:function(){var e=this;if(this.$common.isEmpty(this.account)||this.$common.isEmpty(this.password))this.$message({message:"请输入账号或密码！",type:"error"});else{var t={account:this.account.trim(),password:this.$common.encrypt(this.password.trim())};this.$http.post(this.$constant.baseURL+"/user/login",t,!1,!1).then((function(t){e.$common.isEmpty(t.data)||(e.$store.commit("loadCurrentUser",t.data),localStorage.setItem("userToken",t.data.accessToken),e.account="",e.password="",e.$router.push({path:"/"}))})).catch((function(t){e.$message({message:t.message,type:"error"})}))}},regist:function(){var e=this;if(this.$common.isEmpty(this.username)||this.$common.isEmpty(this.password))this.$message({message:"请输入用户名或密码！",type:"error"});else{if("邮箱验证码"===this.dialogTitle&&this.$common.isEmpty(this.email))return this.$message({message:"请输入邮箱！",type:"error"}),!1;if(this.$common.isEmpty(this.code))this.$message({message:"请输入验证码！",type:"error"});else if(-1===this.username.indexOf(" ")&&-1===this.password.indexOf(" ")){var t={username:this.username.trim(),code:this.code.trim(),password:this.$common.encrypt(this.password.trim())};"邮箱验证码"===this.dialogTitle&&(t.email=this.email),this.$http.post(this.$constant.baseURL+"/user/regist",t).then((function(t){if(!e.$common.isEmpty(t.data)){e.$store.commit("loadCurrentUser",t.data),localStorage.setItem("userToken",t.data.accessToken),e.username="",e.password="",e.$router.push({path:"/"});var s=e.$common.encrypt(localStorage.getItem("userToken"));window.open(e.$constant.imBaseURL+"?userToken="+s)}})).catch((function(t){e.$message({message:t.message,type:"error"})}))}else this.$message({message:"用户名或密码不能包含空格！",type:"error"})}},submitUserInfo:function(){var e=this;if(this.checkParameters()){var t={username:this.currentUser.username,gender:this.currentUser.gender};this.$common.isEmpty(this.currentUser.introduction)||(t.introduction=this.currentUser.introduction.trim()),this.$confirm("确认保存？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success",center:!0}).then((function(){e.$http.post(e.$constant.baseURL+"/user/updateUserInfo",t).then((function(t){e.$common.isEmpty(t.data)||(e.$store.commit("loadCurrentUser",t.data),e.currentUser=e.$store.state.currentUser,e.$message({message:"修改成功！",type:"success"}))})).catch((function(t){e.$message({message:t.message,type:"error"})}))})).catch((function(){e.$message({type:"success",message:"已取消保存!"})}))}},checkParams:function(e){return"修改手机号"===this.dialogTitle||"绑定手机号"===this.dialogTitle||"找回密码"===this.dialogTitle&&1===this.passwordFlag?(e.flag=1,this.$common.isEmpty(this.phoneNumber)?(this.$message({message:"请输入手机号！",type:"error"}),!1):/^1[345789]\d{9}$/.test(this.phoneNumber)?(e.place=this.phoneNumber,!0):(this.$message({message:"手机号格式有误！",type:"error"}),!1)):("修改邮箱"===this.dialogTitle||"绑定邮箱"===this.dialogTitle||"邮箱验证码"===this.dialogTitle||"找回密码"===this.dialogTitle&&2===this.passwordFlag)&&(e.flag=2,this.$common.isEmpty(this.email)?(this.$message({message:"请输入邮箱！",type:"error"}),!1):/^\w+@[a-zA-Z0-9]{2,10}(?:\.[a-z]{2,4}){1,3}$/.test(this.email)?(e.place=this.email,!0):(this.$message({message:"邮箱格式有误！",type:"error"}),!1))},checkParameters:function(){return this.$common.isEmpty(this.currentUser.username)?(this.$message({message:"请输入用户名！",type:"error"}),!1):-1===this.currentUser.username.indexOf(" ")||(this.$message({message:"用户名不能包含空格！",type:"error"}),!1)},changeDialog:function(e){if("邮箱验证码"===e){if(this.$common.isEmpty(this.email))return this.$message({message:"请输入邮箱！",type:"error"}),!1;if(!/^\w+@[a-zA-Z0-9]{2,10}(?:\.[a-z]{2,4}){1,3}$/.test(this.email))return this.$message({message:"邮箱格式有误！",type:"error"}),!1}this.dialogTitle=e,this.showDialog=!0},submitDialog:function(){var e=this;if("修改头像"===this.dialogTitle)if(this.$common.isEmpty(this.avatar))this.$message({message:"请上传头像！",type:"error"});else{var t={avatar:this.avatar.trim()};this.$http.post(this.$constant.baseURL+"/user/updateUserInfo",t).then((function(t){e.$common.isEmpty(t.data)||(e.$store.commit("loadCurrentUser",t.data),e.currentUser=e.$store.state.currentUser,e.clearDialog(),e.$message({message:"修改成功！",type:"success"}))})).catch((function(t){e.$message({message:t.message,type:"error"})}))}else"修改手机号"===this.dialogTitle||"绑定手机号"===this.dialogTitle||"修改邮箱"===this.dialogTitle||"绑定邮箱"===this.dialogTitle?this.updateSecretInfo():"找回密码"===this.dialogTitle?1!==this.passwordFlag&&2!==this.passwordFlag?this.$message({message:"请选择找回方式！",type:"error"}):this.updateSecretInfo():"邮箱验证码"===this.dialogTitle&&(this.showDialog=!1)},updateSecretInfo:function(){var e=this;if(this.$common.isEmpty(this.code))this.$message({message:"请输入验证码！",type:"error"});else if(this.$common.isEmpty(this.password))this.$message({message:"请输入密码！",type:"error"});else{var t={code:this.code.trim(),password:this.$common.encrypt(this.password.trim())};this.checkParams(t)&&("找回密码"===this.dialogTitle?this.$http.post(this.$constant.baseURL+"/user/updateForForgetPassword",t,!1,!1).then((function(t){e.clearDialog(),e.$message({message:"修改成功，请重新登陆！",type:"success"})})).catch((function(t){e.$message({message:t.message,type:"error"})})):this.$http.post(this.$constant.baseURL+"/user/updateSecretInfo",t,!1,!1).then((function(t){e.$common.isEmpty(t.data)||(e.$store.commit("loadCurrentUser",t.data),e.currentUser=e.$store.state.currentUser,e.clearDialog(),e.$message({message:"修改成功！",type:"success"}))})).catch((function(t){e.$message({message:t.message,type:"error"})})))}},getCode:function(){var e=this;if("验证码"===this.codeString){var t,s={};if(!this.checkParams(s))return;t="找回密码"===this.dialogTitle||"邮箱验证码"===this.dialogTitle?"/user/getCodeForForgetPassword":"/user/getCodeForBind",this.$http.get(this.$constant.baseURL+t,s).then((function(t){e.$message({message:"验证码已发送，请注意查收！",type:"success"})})).catch((function(t){e.$message({message:t.message,type:"error"})})),this.codeString="30",this.intervalCode=setInterval((function(){"0"===e.codeString?(clearInterval(e.intervalCode),e.codeString="验证码"):e.codeString=parseInt(e.codeString)-1+""}),1e3)}else this.$message({message:"请稍后再试！",type:"warning"})},clearDialog:function(){this.password="",this.phoneNumber="",this.email="",this.avatar="",this.showDialog=!1,this.code="",this.dialogTitle="",this.passwordFlag=null}}},l=n,c=(s("abe2"),s("2877")),m=Object(c["a"])(l,a,i,!1,null,"4f6c6a1b",null);t["default"]=m.exports},abe2:function(e,t,s){"use strict";s("f031")},f031:function(e,t,s){}}]);